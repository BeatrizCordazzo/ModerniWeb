<app-nav></app-nav>

<main class="checkout-page">
  <div class="checkout-container">
    <h1>Checkout</h1>

    @if (cartItems.length > 0) {
      <section class="checkout-items">
        @for (it of cartItems; track it.id ?? it.name ?? it) {
          <article class="checkout-item">
            <img [src]="it.image" [alt]="it.name" />
            <div class="info">
              <h3>{{ it.name }}</h3>
              <p>{{ it.description }}</p>
              <div class="meta">Quantity: {{ it.quantity || 1 }} Â· Unit price: ${{ it.price.toLocaleString() }}</div>
            </div>
            <div class="line-total">${{ ((it.price || 0) * (it.quantity || 1)).toLocaleString() }}</div>
          </article>
        }
      </section>
    }

    <aside class="checkout-summary">
      <h2>Summary</h2>
      <div class="row"><span>Subtotal</span><span>${{ getSubtotal().toLocaleString() }}</span></div>
      <!-- Shipping removed per request -->
      <div class="row total"><span>Total</span><span>${{ getTotal().toLocaleString() }}</span></div>

      <div class="payment-form">
        <label>Name on card</label>
        <input type="text" [(ngModel)]="cardName" />

        <label>Card number</label>
        <input type="text" [(ngModel)]="cardNumber" />

        <div class="two-col">
          <div>
            <label>Expiration</label>
            <input type="text" [(ngModel)]="cardExpiry" placeholder="MM/YY" />
          </div>
          <div>
            <label>CVV</label>
            <input type="text" class="cvv-input" [(ngModel)]="cardCvv" />
          </div>
        </div>

        <button class="confirm-btn" (click)="confirmPayment()" [disabled]="loading">
          @if (!loading) {
            <span>Confirm payment</span>
          }
          @if (loading) {
            <span>Processing...</span>
          }
        </button>
      </div>
    </aside>

    @if (cartItems.length === 0) {
      <div class="empty">
        <h3>Your cart is empty</h3>
        <p>Add services and return to this page to complete the payment.</p>
      </div>
    }

    @if (toastVisible) {
      <app-toast-notification [message]="toastMessage" [type]="toastType"></app-toast-notification>
    }
  </div>
</main>

<app-footer></app-footer>
